<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>{{star.name}} Official Store</title>
  <meta http-equiv="cleartype" content="on">
  <meta name="MobileOptimized" content="320">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="shortcut icon" href="../static/img/favicon.ico" type="image/x-icon">
  <link href='https://fonts.googleapis.com/css?family=Bangers' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>

  <script src="../static/js/jquery-1.12.2.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
  <script src="https://checkout.stripe.com/checkout.js"></script>
  <script src="../static/js/velocity.js"></script>
  <script src="../static/js/bootstrap.min.js"></script>
  <script src="../static/js/slideout.min.js"></script>

  <link href="../static/css/bootstrap/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../static/css/shop.css">
  <link rel="stylesheet" href="../static/css/shop-mobile.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>




<!-- MOBILE HTML -->
<body id="mobile">

  <div id="loading"> Please Wait.. Order Processing...</div>
  <script> $('#loading').hide();</script>

  <div id="menu">

    <img class="profile-img" src="{{star.image.profile}}">
    <h2 class="title">{{star.name}}</h2>
    <br>
    <div id="social-media">
      <a class="link" target="_blank" href="{{star.url.youtube}}"><i class="fa fa-youtube"></i></a>
      <a class="link" target="_blank" href="{{star.url.instagram}}"><i class="fa fa-instagram"></i></a>
      <a class="link" target="_blank" href="{{star.url.facebook}}"><i class="fa fa-facebook"></i></a>
      <a class="link" target="_blank" href="{{star.url.twitter}}"><i class="fa fa-twitter"></i></a>
    </div>
    <br><br>

    {% if star.active == false %}
    <button style="width:100%;border-radius:0px;"data-toggle="modal" data-target="#myModal" class="btn btn-success btn-activate" id="customButton"><i class="fa fa-power-off"></i> Activate Store</button>
    {% else %}
    <button style="width:100%;border-radius:0px;"data-toggle="modal" data-target="#customerServiceModal" class="btn btn-info btn-activate" id="customButton"><i class="fa fa-question-circle"></i> Customer Service</button>
    {% endif %}
  </div>


  <div id="cart-menu">

    <div class="cart-and-total">
          <h2 class="title">Cart</h2>

           <span class="money" style="font-size:16px;">Total: $<span class="total-cost">0.00</span></span>
    </div>

    <div id="cart" class="cart" class="well" style="max-height:160px;overflow:auto;padding:5px;">
      <span id="alert-cart-empty"><br><br>The cart is empty!<br>Add a product to the cart by clicking <br>

                                        <button class="btn btn-primary btn-add demo" role="button"><i class="fa fa-cart-plus"></i></button>
                                        <br>
                                      on a product card.</span>


    </div>

    <button class="btn btn-primary btn-checkout customButton" id="customButton"><i class="fa fa-check-circle-o"></i> Checkout</button>
  </div>



  <div class="nav">
      <img class="star-btn" width="50px" src="{{star.image.profile}}">
    <div class="name">
      {{star.name}}
    </div>
    <div class="cart-btn">
      <i class="fa fa-shopping-cart"></i><span class="num-items"></span>
    </div>
  </div>

<main id="panel">

  <div class="content">
    <div class="row">

      {% if star.active == false %}
      <div class="col-md-12">
        <div class="row-fluid">

          <div class="panel panel-activate fade in" role="alert">
            <div class="alert-text"><strong>Heads up {{star.name}}!</strong>
              <br>Click below to activate your store
            <br><br>
            <button data-toggle="modal" data-target="#myModal" class="btn btn-success btn-activate" id="customButton">Activate Store Now</button>
          </div>

        </div>
      </div>
    </div>
    {% endif %}

{% if star.active == false %}
      {% for p in products %}
      <div class="col-xs-12">
        <div class="thumbnail">
          <div class="card-header">
            <span class="hours-remaining"><i class="fa fa-clock-o"></i> 2:23:12</span>
            <img width="30px" class="shipping-icon" src="../static/img/shipping-icon.png">
            <div class="progress">
              <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="40"
              aria-valuemin="0" aria-valuemax="100" style="width:50%">
                <span class="progress-text">50 Orders Needed!</span>
              </div>
            </div>
          </div>
          <img class="product-picture"
               {% if star.samplesUploaded is defined %}
               src="../static/img/sample_products/stars/{{star.id}}/{{p.default_img[0]}}"
               {% else %}
               src="../static/img/sample_products/{{p.category}}/{{p.default_img[0]}}"
               {% endif %}
               alt="...">



          <div class="caption">
            <h3 class="title">{{p.name}}</h3>
            <span class="money">$<span class="price">{{p.price}}</span></span>
            <button class="add-to-cart btn btn-primary btn-add" role="button"><i class="fa fa-cart-plus"></i></button>
            <button class="btn btn-primary btn-view" role="button" data-toggle="modal" data-target="#modal-{{p.sku}}"><i class="fa fa-eye" aria-hidden="true"></i></button>
          </div>

        </div>
      </div>

      <!-- Product Description Modal -->
      <div class="modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" style="z-index:99999;" id="modal-{{p.sku}}">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h2 class="modal-title" id="myModalLabel">{{p.name}} Description</h2>
            <hr>
            <div class="row">
            <div class="col-md-8">
              <img width="500px" height="500px" class="product-picture img-responsive" src="../static/img/sample_products/{{p.category}}/{{p.default_img[0]}}" alt="...">
            </div>
            <div class="col-md-4">
              <div class="product-description">
                  <h2>Order Requirement</h2>
                    <p>This campaign needs atleast <span class="emphasize">{{p.description.minOrderQty}}</span> preorders in order for {{p.name}} to be shipped.</p>
                  <h2>Composition</h2>
                    <p><strong>Material:</strong> {{p.description.material}}</p>
                    <p><strong>Fabric:</strong>  {{p.description.fabric}}</p>
                    <p><strong>Weight:</strong>  {{p.description.weight}}</p>
                    <p><strong>Fabric:</strong>  {{p.description.design}}</p>
                  <h2>Specialty</h2>
                    <p><strong>Special:</strong>  {{p.description.special}}</p>
                    <p><strong>Design:</strong>  Custom designs, logos, colors, and any modifications can be made, just ask!</p>

              </div>
              {% for img in p.default_img %}
              <div class="product-sample-view">
                <img width="50px" height="50px" src="../static/img/sample_products/{{p.category}}/{{img}}">
              </div>
              {% endfor %}
            </div>
          </div>
          </div>
        </div>
      </div>
      {% endfor %}
{% else %}
<!-- ACTIVE STORE PRODUCTS VERSION -->
 {% for p in products %}
 <div class="col-md-6 col-lg-4 filtr-item"
      data-category="{% for id in p.subcatID %}{{id}}{% if not loop.last %}, {% endif %}{% endfor %}"
      data-sort="Create Your Own" style="padding: 15px;padding-top:0px;padding-bottom:0px;">

   <div class="thumbnail">


       <span class="product-id">{{p.sku}}</span>
       <div class="card-header">
         <span class="hours-remaining">
           <i class="fa fa-clock-o"></i>
           <span class="time">{{p.endTime}}</span>
         </span>
         <img width="30px" class="shipping-icon" style="opacity:.5;" src="../static/img/shipping-icon.png">
         <div class="progress">
           <span class="progress-text" style="color:#9d9d9d;">{{(p.minQty - p.currentQty)|round|int}} Orders Needed!</span>
           <div class="progress-bar progress-bar-primary progress-bar-striped" role="progressbar" aria-valuenow="{{p.currentQty}}"
           aria-valuemin="0" aria-valuemax="{{p.minQty}}" style="width:{{p.currentQty + 1}}%">

           </div>
         </div>
       </div>
       <img width="500px" height="500px" data-toggle="modal" data-target="#modal-{{p.sku}}" class="product-picture" src="../static/img/products/{{star.id}}/{{p.default_img[0]}}" alt="...">

       <div class="row variations">
           <div class="col-lg-6 variation1">
             <div class="name"><span>size</span></div>
             <select class="form-control">
               {% for s in p.variations.size %}
               <option>{{s}}</option>
               {% endfor %}
             </select>
           </div>
           {% if p.variations.color[0].name is defined %}
           <div class="col-lg-6 variation2">
             <div class="name"><span>color</span></div>
             <select class="form-control">
                 {% for c in p.variations.color %}
                 <option
                   data-src="../static/img/products/{{star.id}}/{{c.img[0]}}">
                   {{c.name}}
                 </option>
                 {% endfor %}
             </select>
           </div>
           {% endif %}
       </div>

       <div class="caption">
         <h3 class="title">{{p.name}}</h3>
         <span class="money">$<span class="price">{{p.price}}</span></span>
         <button class="add-to-cart btn btn-primary btn-add" role="button"><i class="fa fa-cart-plus"></i></button>
         <button class="btn btn-primary btn-view" role="button" data-toggle="modal" data-target="#modal-{{p.sku}}"><i class="fa fa-eye" aria-hidden="true"></i></button>
       </div>
   </div>
 </div>


 <!-- Product Description Modal -->
 <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" style="z-index:99999;" id="modal-{{p.sku}}">
   <div class="modal-dialog modal-lg">
     <div class="modal-content">
       <button type="button" class="close" data-dismiss="modal" aria-label="Close">
         <span aria-hidden="true">&times;</span>
       </button>
       <h2 class="modal-title" id="myModalLabel">{{p.name}} Description</h2>
       <hr>
       <div class="row">
       <div class="col-md-8">
         <img width="500px" height="500px" class="product-picture img-responsive" src="../static/img/products/{{star.id}}/{{p.default_img[0]}}" alt="...">
       </div>
       <div class="col-md-4">
         <div class="product-description">
             <h2>Order Requirement</h2>
               <p>This campaign needs atleast <span class="emphasize">{{p.description.minOrderQty}}</span> preorders in order for {{p.name}} to be shipped.</p>
             <h2>Composition</h2>
               <p><strong>Material:</strong> {{p.description.material}}</p>
               <p><strong>Fabric:</strong>  {{p.description.fabric}}</p>
               <p><strong>Weight:</strong>  {{p.description.weight}}</p>
               <p><strong>Fabric:</strong>  {{p.description.design}}</p>
             <h2>Specialty</h2>
               <p><strong>Special:</strong>  {{p.description.special}}</p>
               <p><strong>Design:</strong>  Custom designs, logos, colors, and any modifications can be made, just ask!</p>

         </div>
         {% for v in p.variations.color %}
         {% for i in v.img %}
         <div class="product-sample-view">
           <img width="50px" height="50px" src="../static/img/products/{{star.id}}/{{i}}">
         </div>
         {% endfor %}
         {% endfor %}
       </div>
     </div>
     </div>
   </div>
 </div>
 {% endfor %}
{% endif %}

    </div>




    </div>

    </main>






  <script>
    var menu = new Slideout({
      'panel': document.getElementById('panel'),
      'menu': document.getElementById('menu'),
      'padding': 256,
      'tolerance': 70,
      'side': 'left',
      'touch': false
    });

    var cartMenu = new Slideout({
      'panel': document.getElementById('panel'),
      'menu': document.getElementById('cart-menu'),
      'padding': 256,
      'tolerance': 70,
      'side': 'right',
      'touch': false
    });

    //menu toggle
    document.querySelector('.star-btn').addEventListener('click', function() {
      menu.toggle();
      $('#cart-menu').css('z-index', -1);
      $('#menu').css('z-index', 0);
    });

    //cart toggle
    // Toggle button
    document.querySelector('.cart-btn').addEventListener('click', function() {

      cartMenu.toggle();
      $('#menu').css('z-index', -1);
      $('#cart-menu').css('z-index', 0);

    });

  </script>


</div>



</body>

</html>

<!-- MODAL -->
<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal">
<div class="modal-dialog modal-sm">
  <div class="modal-content">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>

    <p>
      Fill out the form below
      <br>
      We will contact you within 24 hours
    </p>

    <form id="activate-store-modal-form" action="/activateStore" method="post">
      <div class="row">
        <div class="col-xs-6">
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-user"></i></span>
            <input id="activate_firstname" name="firstname" type="text" class="form-control" placeholder="Name" autofocus/>
          </div>
          <br>
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-phone-square"></i></span>
            <input id="activate_phone" name="phone" type="tel" class="form-control" placeholder="Phone" />
          </div>
          <br>
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-envelope"></i></span>
            <input id="activate_email" name="email" type="email" class="form-control" placeholder="Email" value="{{star.email[0]}}"/>
          </div>
        </div>

        <div class="col-xs-6">
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-youtube"></i></span>
            <input id="activate_youtube" name="youtube" type="url" class="form-control" placeholder="Youtube Channel URL" value="{{star.url.youtube}}"/>
          </div>
          <br>
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-instagram"></i></span>
            <input id="activate_instagram" name="instagram" type="text" class="form-control" placeholder="Instagram Username" value="{{star.url.instagram}}" />
          </div>
          <br>
          <div class="input-group input-group-sm">
            <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-facebook-square"></i></span>
            <input id="activate_facebook" name="facebook" type="text" class="form-control" placeholder="Facebook Fan Page URL" value="{{star.url.facebook}}"/>
          </div>
        </div>
      </div>
      <p id="activate-store-notification"></p>
      <button type="submit" class="btn btn-primary center btn-submit" id="activate-store-button">Submit</button>

    </form>
  </div>
</div>
</div>

  <!-- MODAL -->
  <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="customerServiceModal">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <!--<h2 class="modal-title" id="myModalLabel">Activate Store</h2>-->
      <p>
        Fill out the form below
        <br>
        We will contact you within 24 hours
      </p>

      <form id="activate-store-modal-form" action="/activateStore" method="post">
        <div class="row">
          <div class="col-xs-6">
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-user"></i></span>
              <input id="activate_firstname" name="firstname" type="text" class="form-control" placeholder="Name" autofocus/>
            </div>
            <br>
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-phone-square"></i></span>
              <input id="activate_phone" name="phone" type="tel" class="form-control" placeholder="Phone" />
            </div>
            <br>
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-envelope"></i></span>
              <input id="activate_email" name="email" type="email" class="form-control" placeholder="Email" value="{{star.email[0]}}"/>
            </div>
          </div>

          <div class="col-xs-6">
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-youtube"></i></span>
              <input id="activate_youtube" name="youtube" type="url" class="form-control" placeholder="Youtube Channel URL" value="{{star.url.youtube}}"/>
            </div>
            <br>
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-instagram"></i></span>
              <input id="activate_instagram" name="instagram" type="text" class="form-control" placeholder="Instagram Username" value="{{star.url.instagram}}" />
            </div>
            <br>
            <div class="input-group input-group-sm">
              <span class="input-group-addon" id="sizing-addon1"><i class="fa fa-facebook-square"></i></span>
              <input id="activate_facebook" name="facebook" type="text" class="form-control" placeholder="Facebook Fan Page URL" value="{{star.url.facebook}}"/>
            </div>
          </div>
        </div>
        <p id="activate-store-notification"></p>
        <button type="submit" class="btn btn-primary center btn-submit" id="activate-store-button">Submit</button>

      </form>
    </div>
  </div>
</div>


<!-- Payment Success Modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="paymentSuccessModal">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <h2 class="modal-title" id="myModalLabel">Order Successful!</h2>
      <p>You should receive a receipt shortly</p>
      <hr>
      <p>If the product(s) you ordered do not reach a minimum order you get a full refund.</p>
      <br>
      <p>Questions or concerns? Email us at <strong>support@fandemic.co</strong> and we will respond within 24 hours. Thanks!</p>
    </div>
  </div>
</div>


<script>
(function ($) {
$('.spinner .btn:first-of-type').on('click', function() {
  $('.spinner input').val( parseInt($('.spinner input').val(), 10) + 1);
});
$('.spinner .btn:last-of-type').on('click', function() {
  $('.spinner input').val( parseInt($('.spinner input').val(), 10) - 1);
});
})(jQuery);
</script>

<script src="../static/js/countdown.min.js"></script>
<script src="../static/js/shop.js"></script>
<script src="../static/js/mobile.js"></script>

<script>
var handler = StripeCheckout.configure({
{% if star.active == false %}
key: 'pk_test_z1mq9KQ3GyakW5OdduPIX94u',
{% else %}
key: 'pk_live_kyvM71oajfwVWnxBoy7SfqOp',
{% endif %}
image: '{{star.image.profile}}',
locale: 'auto',
token: function(token,args) {

  //gather info from the order
  var info = {};
  info['star'] = "{{star.name}}";
  info['active'] = "{{star.active}}";
  info['amount'] = Math.round(total_cost * 100);
  info['cart'] = cart;

  //combine all info into one object
  var result={};
  $.extend(result, args, token);
  $.extend(result, result, info);

  $.ajax({
    type: 'POST',
    url: '/charge',
    data: JSON.stringify(result, null, '\t'),
    contentType: 'application/json;charset=UTF-8',
    success: function(response) {
      $("#paymentSuccessModal").modal()
      resetCart();
    },
    error: function(error) {
      alert("payment error");
    }
  });

}
});


$( document ).ajaxStart(function () {
  $('#loading').show();  // show loading indicator
});

$( document ).ajaxStop(function()
{
    $('#loading').hide();  // hide loading indicator
});



$('.customButton').on('click', function(e) {
// Open Checkout with further options
handler.open({
name: 'ORDER TOTAL',
description: '$' + total_cost.formatMoney(2),
zipCode: true,
billingAddress: true,
shippingAddress: true,
allowRememberMe: true,
panelLabel: "Pay",
amount: Math.round(total_cost * 100)
});
e.preventDefault();
});

// Close Checkout on page navigation
$(window).on('popstate', function() {
handler.close();
});

//bootstrap autofocus modal
$('.modal').on('shown.bs.modal', function() {
  menu.close();
  $(this).find('[autofocus]').focus();
});

</script>

{% include 'analytics.html' %}
